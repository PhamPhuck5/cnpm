{
  "info": {
    "_postman_id": "b5d6e7f8-1234-5678-9abc-def012345678",
    "name": "Apartment Management API",
    "description": "Collection test đầy đủ các API cho hệ thống quản lý chung cư.\nBao gồm tự động hóa Auth Token.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login (Auto-set Token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.accessToken) {",
                  "    pm.collectionVariables.set(\"access_token\", jsonData.accessToken);",
                  "    console.log(\"Token updated successfully\");",
                  "} else {",
                  "    console.log(\"Token not found in response\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"123456\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": ["{{base_url}}"],
              "path": ["api", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Nguyen Van A\",\n    \"phonenumber\": \"0987654321\",\n    \"email\": \"user@example.com\",\n    \"password\": \"123456\",\n    \"apartmentId\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/register",
              "host": ["{{base_url}}"],
              "path": ["api", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Change Password",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"user@example.com\",\n    \"newPassword\": \"newpass123\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/forgot",
              "host": ["{{base_url}}"],
              "path": ["api", "forgot"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Apartment",
      "item": [
        {
          "name": "Get Apartment By User",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/apartment",
              "host": ["{{base_url}}"],
              "path": ["api", "apartment"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Apartments",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/apartments",
              "host": ["{{base_url}}"],
              "path": ["api", "apartments"]
            }
          },
          "response": []
        },
        {
          "name": "Create Apartment",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Chung cu Royal City\",\n    \"address\": \"72 Nguyen Trai\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/apartments",
              "host": ["{{base_url}}"],
              "path": ["api", "apartments"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Household",
      "item": [
        {
          "name": "Create Household",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"room\": \"P101\",\n    \"number_motorbike\": 2,\n    \"number_car\": 1,\n    \"start_date\": \"2023-01-01\",\n    \"type\": \"VIP\",\n    \"feePerMeter\": 5000\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/households/create",
              "host": ["{{base_url}}"],
              "path": ["api", "households", "create"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Households",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/households",
              "host": ["{{base_url}}"],
              "path": ["api", "households"]
            }
          },
          "response": []
        },
        {
          "name": "Get Living Households",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/households/living",
              "host": ["{{base_url}}"],
              "path": ["api", "households", "living"]
            }
          },
          "response": []
        },
        {
          "name": "Get Living Household By RoomName",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/household/roomname/living/:name",
              "host": ["{{base_url}}"],
              "path": ["api", "household", "roomname", "living", ":name"],
              "variable": [
                {
                  "key": "name",
                  "value": "P101"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Household Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/households/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "households", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Stop Living",
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"room\": \"P101\",\n    \"stopTime\": \"2023-12-31\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/households/stop-living",
              "host": ["{{base_url}}"],
              "path": ["api", "households", "stop-living"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Human",
      "item": [
        {
          "name": "Create Human",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"household_id\": 1,\n    \"name\": \"Nguyen Van B\",\n    \"phonenumber\": \"0912345678\",\n    \"email\": \"child@example.com\",\n    \"dateOfBirth\": \"2000-01-01\",\n    \"role\": \"member\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/humans",
              "host": ["{{base_url}}"],
              "path": ["api", "humans"]
            }
          },
          "response": []
        },
        {
          "name": "Set Living True",
          "request": {
            "method": "PATCH",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/humans/:humanId/status/living",
              "host": ["{{base_url}}"],
              "path": ["api", "humans", ":humanId", "status", "living"],
              "variable": [
                {
                  "key": "humanId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Set Living False (Leave)",
          "request": {
            "method": "PATCH",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/humans/:humanId/status/leave",
              "host": ["{{base_url}}"],
              "path": ["api", "humans", ":humanId", "status", "leave"],
              "variable": [
                {
                  "key": "humanId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Humans by Household",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/humans/household/:householdId",
              "host": ["{{base_url}}"],
              "path": ["api", "humans", "household", ":householdId"],
              "variable": [
                {
                  "key": "householdId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Humans in Apartment",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/humans/household/",
              "host": ["{{base_url}}"],
              "path": ["api", "humans", "household", ""]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Room (New)",
      "item": [
        {
          "name": "Get All Rooms",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/room/all",
              "host": ["{{base_url}}"],
              "path": ["api", "room", "all"]
            }
          },
          "response": []
        },
        {
          "name": "Get Empty Rooms",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/room/empty",
              "host": ["{{base_url}}"],
              "path": ["api", "room", "empty"]
            }
          },
          "response": []
        },
        {
          "name": "Get Occupied Rooms",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/room/occupied",
              "host": ["{{base_url}}"],
              "path": ["api", "room", "occupied"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Bill",
      "item": [
        {
          "name": "Create Bill",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Tien dien thang 5\",\n    \"start_date\": \"2023-05-01\",\n    \"end_date\": \"2023-05-31\",\n    \"amount\": 1000000,\n    \"based\": 3000\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/bills",
              "host": ["{{base_url}}"],
              "path": ["api", "bills"]
            }
          },
          "response": []
        },
        {
          "name": "Get Bills of Apartment",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/bills/my-apartment",
              "host": ["{{base_url}}"],
              "path": ["api", "bills", "my-apartment"]
            }
          },
          "response": []
        },
        {
          "name": "Get Bill By Id",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/bills/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "bills", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Payment",
      "item": [
        {
          "name": "Create Payment",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"bill_id\": 1,\n    \"amount\": 500000,\n    \"household_id\": 1\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/payments",
              "host": ["{{base_url}}"],
              "path": ["api", "payments"]
            }
          },
          "response": []
        },
        {
          "name": "Get Payments by Bill",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/payments/bill-list/:billId",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "bill-list", ":billId"],
              "variable": [
                {
                  "key": "billId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update Payment",
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"amount\": 600000,\n    \"require\": \"update reason\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/payments/update/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "payments", "update", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Resident Record",
      "item": [
        {
          "name": "Create Record (Tam vang)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"humanId\": 1,\n    \"start_date\": \"2023-06-01\",\n    \"last_date\": \"2023-06-10\",\n    \"isAbsent\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/records",
              "host": ["{{base_url}}"],
              "path": ["api", "records"]
            }
          },
          "response": []
        },
        {
          "name": "End Record",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"record_id\": 1,\n    \"last_date\": \"2023-06-09\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/api/records/end",
              "host": ["{{base_url}}"],
              "path": ["api", "records", "end"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{access_token}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3003",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    }
  ]
}
